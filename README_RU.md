# ะัะธะปะพะถะตะฝะธะต "ะะพะณะพะดะฐ" ๐ค๏ธ

ะะตะฑ-ะฟัะธะปะพะถะตะฝะธะต ะฝะฐ Symfony ะดะปั ะฟะพะปััะตะฝะธั ะธะฝัะพัะผะฐัะธะธ ะพ ะฟะพะณะพะดะต ะฒ ัะตะถะธะผะต ัะตะฐะปัะฝะพะณะพ ะฒัะตะผะตะฝะธ ั ะธะฝัะตะปะปะตะบััะฐะปัะฝะพะน ัะธััะตะผะพะน ะบะตัะธัะพะฒะฐะฝะธั.

## ๐ ะกะพะดะตัะถะฐะฝะธะต

- [ะะพะทะผะพะถะฝะพััะธ](#ะฒะพะทะผะพะถะฝะพััะธ)
- [ะขัะตะฑะพะฒะฐะฝะธั](#ััะตะฑะพะฒะฐะฝะธั)
- [ะัััััะน ััะฐัั](#ะฑัััััะน-ััะฐัั)
- [ะััะธัะตะบัััะฐ](#ะฐััะธัะตะบัััะฐ)
- [ะัะฟะพะปัะทะพะฒะฐะฝะธะต](#ะธัะฟะพะปัะทะพะฒะฐะฝะธะต)
- [API ะดะพะบัะผะตะฝัะฐัะธั](#api-ะดะพะบัะผะตะฝัะฐัะธั)
- [ะขะตััะธัะพะฒะฐะฝะธะต](#ัะตััะธัะพะฒะฐะฝะธะต)
- [ะกัััะบัััะฐ ะฟัะพะตะบัะฐ](#ััััะบัััะฐ-ะฟัะพะตะบัะฐ)

## ๐ ะะพะทะผะพะถะฝะพััะธ

### ะัะฝะพะฒะฝัะต ััะฝะบัะธะธ
- โ ะะพะปััะตะฝะธะต ะดะฐะฝะฝัั ะพ ะฟะพะณะพะดะต ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ ัะตัะตะท WeatherAPI.com
- โ ะะฝัะตะปะปะตะบััะฐะปัะฝะพะต ะบะตัะธัะพะฒะฐะฝะธะต ั ะฝะฐัััะฐะธะฒะฐะตะผัะผ TTL (ะฟะพ ัะผะพะปัะฐะฝะธั 30 ะผะธะฝัั)
- โ ะะฒัะพะผะฐัะธัะตัะบะธะน ะฒะพะทะฒัะฐั ะบ ัััะฐัะตะฒัะธะผ ะดะฐะฝะฝัะผ ะฟัะธ ะฝะตะดะพัััะฟะฝะพััะธ API
- โ ะะตะฑ-ะธะฝัะตััะตะนั ะธ RESTful API
- โ ะะพะผะฟะปะตะบัะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ั ะพัะดะตะปัะฝัะผ ะบะฐะฝะฐะปะพะผ ะดะปั ะฟะพะณะพะดั
- โ Docker-ะพะบััะถะตะฝะธะต ะดะปั ัะฐะทัะฐะฑะพัะบะธ
- โ ะะพะปะฝะพะต ะฟะพะบัััะธะต ัะตััะฐะผะธ (unit ะธ ััะฝะบัะธะพะฝะฐะปัะฝัะต)

### ะขะตัะฝะพะปะพะณะธะธ
- **PHP 8.4** ั Xdebug
- **Symfony 7.3 LTS**
- **Doctrine ORM** ั MySQL 8.0
- **Docker & Docker Compose**
- **PHPUnit** ะดะปั ัะตััะธัะพะฒะฐะฝะธั
- **Bootstrap 5** ะดะปั UI

## ๐ฆ ะขัะตะฑะพะฒะฐะฝะธั

- Docker ะธ Docker Compose
- Make (ะดะปั ัะดะพะฑะฝัั ะบะพะผะฐะฝะด)
- Git

## ๐ ะัััััะน ััะฐัั

### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั
```bash
git clone https://github.com/your-repo/weather-app.git
cd weather-app
```

### 2. ะะฐัััะพะนะบะฐ ะพะบััะถะตะฝะธั
```bash
# ะะพะฟะธััะตะผ ัะฐะนะป ั ะฟะตัะตะผะตะฝะฝัะผะธ ะพะบััะถะตะฝะธั
cp .env.local.example .env.local

# ะะตะดะฐะบัะธััะตะผ .env.local ะธ ะดะพะฑะฐะฒะปัะตะผ ะฒะฐั API ะบะปัั
# WEATHER_API_KEY=ะฒะฐั_ะบะปัั_api
```

### 3. ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั
```bash
# ะะพะปะฝะฐั ัััะฐะฝะพะฒะบะฐ ะธ ะทะฐะฟััะบ
make setup

# ะัะธะปะพะถะตะฝะธะต ะฑัะดะตั ะดะพัััะฟะฝะพ ะฟะพ ะฐะดัะตัั:
# http://localhost:8080
```

## ๐๏ธ ะััะธัะตะบัััะฐ

### ะกัััะบัััะฐ ัะตัะฒะธัะพะฒ

```
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโ
โ   Browser   โโโโโโถโ  WeatherControllerโโโโโโถโWeatherServiceโ
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโโโ     โโโโโโโโฌโโโโโโโโ
                                                     โ
                           โโโโโโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโ
                           โผ                                   โผ
                    โโโโโโโโโโโโโโโโ                 โโโโโโโโโโโโโโโโโโโโโ
                    โWeatherApiClientโ               โWeatherCacheServiceโ
                    โโโโโโโโฌโโโโโโโโ                 โโโโโโโโโฌโโโโโโโโโโโโ
                           โ                                 โ
                           โผ                                 โผ
                    โโโโโโโโโโโโโโโโ                 โโโโโโโโโโโโโโโโโ
                    โ WeatherAPI   โ                 โ   MySQL DB    โ
                    โโโโโโโโโโโโโโโโ                 โโโโโโโโโโโโโโโโโ
```

### ะกััะฐัะตะณะธั ะบะตัะธัะพะฒะฐะฝะธั

1. **Cache First**: ะกะฝะฐัะฐะปะฐ ะฟัะพะฒะตััะตััั ะบะตั ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั
2. **TTL-based**: ะะฐัััะฐะธะฒะฐะตะผะพะต ะฒัะตะผั ะถะธะทะฝะธ ะบะตัะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั 30 ะผะธะฝัั)
3. **Stale Fallback**: ะะพะทะฒัะฐั ัััะฐัะตะฒัะธั ะดะฐะฝะฝัั ะฟัะธ ัะฑะพะต API
4. **Per-City Storage**: ะะฐะฝะฝัะต ะบะตัะธัััััั ะดะปั ะบะฐะถะดะพะณะพ ะณะพัะพะดะฐ ะพัะดะตะปัะฝะพ

## ๐ป ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะตะฑ-ะธะฝัะตััะตะนั

#### ะัะพัะผะพัั ะฟะพะณะพะดั
```
http://localhost:8080/weather/Odessa
http://localhost:8080/weather/Saint-Petersburg
http://localhost:8080/weather/New York
```

#### ะัะธะฝัะดะธัะตะปัะฝะพะต ะพะฑะฝะพะฒะปะตะฝะธะต
```
http://localhost:8080/weather/Odessa?refresh=true
```

### API ัะฝะดะฟะพะธะฝัั

#### 1. ะะพะปััะธัั ะดะฐะฝะฝัะต ะพ ะฟะพะณะพะดะต
```bash
# ะะฑััะฝัะน ะทะฐะฟัะพั
curl http://localhost:8080/api/weather/Odessa

# ะก ัะพัะผะฐัะธัะพะฒะฐะฝะธะตะผ
curl http://localhost:8080/api/weather/Odessa | jq

# ะัะธะฝัะดะธัะตะปัะฝะพะต ะพะฑะฝะพะฒะปะตะฝะธะต (ะธะณะฝะพัะธัะพะฒะฐัั ะบะตั)
curl "http://localhost:8080/api/weather/Odessa?refresh=true"
```

**ะฃัะฟะตัะฝัะน ะพัะฒะตั:**
```json
{
  "success": true,
  "data": {
    "city": "Odessa",
    "country": "Ukraine",
    "temperature": -15.0,
    "condition": "ะกะฝะตะณ",
    "humidity": 85,
    "wind_speed": 15.0,
    "last_updated": "2025-06-17 12:00:00",
    "api_last_updated": "2025-06-17 11:45",
    "cached": true,
    "cache_age_minutes": 15,
    "stale": false
  }
}
```

#### 2. ะัะธััะธัั ะบะตั ะณะพัะพะดะฐ
```bash
curl -X POST http://localhost:8080/api/weather/Odessa/cache/clear
# ะธะปะธ
curl -X DELETE http://localhost:8080/api/weather/Odessa/cache/clear
```

#### 3. ะะพะปััะธัั ััะฐัะธััะธะบั ะบะตัะฐ
```bash
curl http://localhost:8080/api/weather/cache/stats | jq
```

**ะัะฒะตั:**
```json
{
  "success": true,
  "data": {
    "total_cached_cities": 5,
    "fresh_cache_entries": 3,
    "stale_cache_entries": 2,
    "cache_max_age_minutes": 30
  }
}
```

#### 4. API ะดะพะบัะผะตะฝัะฐัะธั
```bash
curl http://localhost:8080/api/weather | jq
```

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะะฐะฟััะบ ัะตััะพะฒ
```bash
# ะัะต ัะตััั
make test

# ะขะพะปัะบะพ unit ัะตััั
make test-unit

# ะขะพะปัะบะพ ััะฝะบัะธะพะฝะฐะปัะฝัะต ัะตััั
make test-functional
```

### ะะพะบัััะธะต ัะตััะฐะผะธ
- **Unit ัะตััั**: 40 ัะตััะพะฒ
- **ะคัะฝะบัะธะพะฝะฐะปัะฝัะต ัะตััั**: 14 ัะตััะพะฒ
- **ะัะตะณะพ assertions**: 261

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
weather-app/
โโโ config/                 # ะะพะฝัะธะณััะฐัะธั Symfony
โ   โโโ packages/          # ะะฐัััะพะนะบะธ ะฟะฐะบะตัะพะฒ
โ   โ   โโโ doctrine.yaml  # ะะพะฝัะธะณััะฐัะธั ะะ
โ   โ   โโโ monolog.yaml   # ะะพะณะธัะพะฒะฐะฝะธะต
โ   โ   โโโ test/         # ะขะตััะพะฒะพะต ะพะบััะถะตะฝะธะต
โ   โโโ services.yaml      # ะะฟัะตะดะตะปะตะฝะธะต ัะตัะฒะธัะพะฒ
โโโ docker/                # Docker ะบะพะฝัะธะณััะฐัะธั
โ   โโโ nginx/            # ะะตะฑ-ัะตัะฒะตั
โ   โโโ php/              # PHP ะบะพะฝัะตะนะฝะตั
โโโ migrations/            # ะะธะณัะฐัะธะธ ะะ
โโโ public/               # ะัะฑะปะธัะฝะฐั ะดะธัะตะบัะพัะธั
โโโ src/                  # ะััะพะดะฝัะน ะบะพะด
โ   โโโ Controller/       # ะะพะฝััะพะปะปะตัั
โ   โโโ Entity/          # Doctrine ัััะฝะพััะธ
โ   โโโ Exception/       # ะะฐััะพะผะฝัะต ะธัะบะปััะตะฝะธั
โ   โโโ Form/            # Symfony ัะพัะผั
โ   โโโ Repository/      # ะะตะฟะพะทะธัะพัะธะธ
โ   โโโ Service/         # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โโโ templates/            # Twig ัะฐะฑะปะพะฝั
โโโ tests/               # ะขะตััั
โ   โโโ Unit/           # Unit ัะตััั
โ   โโโ Functional/     # ะคัะฝะบัะธะพะฝะฐะปัะฝัะต ัะตััั
โโโ var/                 # ะะตั, ะปะพะณะธ
โโโ .env.local.example   # ะัะธะผะตั ะบะพะฝัะธะณััะฐัะธะธ
โโโ docker-compose.yml   # Docker ะฝะฐัััะพะนะบะธ
โโโ Makefile            # ะะพะผะฐะฝะดั ะดะปั ัะฟัะฐะฒะปะตะฝะธั
โโโ README_RU.md        # ะญัะพั ัะฐะนะป
```

## ๐๏ธ ะะพะผะฐะฝะดั Make

### ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั
```bash
make help        # ะะพะบะฐะทะฐัั ะฒัะต ะดะพัััะฟะฝัะต ะบะพะผะฐะฝะดั
make setup       # ะะพะปะฝะฐั ัััะฐะฝะพะฒะบะฐ ะฟัะพะตะบัะฐ
make up          # ะะฐะฟัััะธัั ะบะพะฝัะตะนะฝะตัั
make down        # ะััะฐะฝะพะฒะธัั ะบะพะฝัะตะนะฝะตัั
make restart     # ะะตัะตะทะฐะฟัััะธัั ะบะพะฝัะตะนะฝะตัั
```

### ะะฐะทะฐ ะดะฐะฝะฝัั
```bash
make db-create   # ะกะพะทะดะฐัั ะฑะฐะทั ะดะฐะฝะฝัั
make db-migrate  # ะัะฟะพะปะฝะธัั ะผะธะณัะฐัะธะธ
make db-fixtures # ะะฐะณััะทะธัั ัะตััะพะฒัะต ะดะฐะฝะฝัะต
make db-reset    # ะะพะปะฝัะน ัะฑัะพั ะะ
make test-db     # ะะฐัััะพะธัั ัะตััะพะฒัั ะะ
```

### ะะฐะทัะฐะฑะพัะบะฐ
```bash
make shell       # ะะพะนัะธ ะฒ PHP ะบะพะฝัะตะนะฝะตั
make logs        # ะัะพัะผะพัั ะปะพะณะพะฒ ะฟะพะณะพะดั
make cache-clear # ะัะธััะธัั ะบะตั Symfony
make install     # ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ
```

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั (.env.local)

```bash
# API ะบะพะฝัะธะณััะฐัะธั
WEATHER_API_KEY=ะฒะฐั_ะบะปัั_api_ะทะดะตัั
WEATHER_API_URL=https://api.weatherapi.com/v1
WEATHER_CACHE_MAX_AGE_MINUTES=30

# ะะฐะทะฐ ะดะฐะฝะฝัั
DATABASE_URL="mysql://weather_user:weather_pass@mysql:3306/weather_db?serverVersion=8.0"

# ะะบััะถะตะฝะธะต
APP_ENV=dev
APP_DEBUG=1
```

### ะะพะปััะตะฝะธะต API ะบะปััะฐ

1. ะะฐัะตะณะธัััะธััะนัะตัั ะฝะฐ https://www.weatherapi.com/signup.aspx
2. ะะพะปััะธัะต ะฑะตัะฟะปะฐัะฝัะน API ะบะปัั (1 ะผะธะปะปะธะพะฝ ะทะฐะฟัะพัะพะฒ ะฒ ะผะตััั)
3. ะะพะฑะฐะฒััะต ะบะปัั ะฒ ัะฐะนะป `.env.local`

## ๐ ะะพะณะธัะพะฒะฐะฝะธะต

ะัะธะปะพะถะตะฝะธะต ะธัะฟะพะปัะทัะตั ะพัะดะตะปัะฝัะน ะบะฐะฝะฐะป `weather` ะดะปั ะปะพะณะธัะพะฒะฐะฝะธั:

```bash
# ะัะพัะผะพัั ะปะพะณะพะฒ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
make logs

# ะะปะธ ะฒัััะฝัั
docker compose exec php tail -f var/log/weather_dev.log
```

### ะฃัะพะฒะฝะธ ะปะพะณะธัะพะฒะฐะฝะธั
- **INFO**: ะะฑัะฐั ะธะฝัะพัะผะฐัะธั ะพ ะทะฐะฟัะพัะฐั
- **DEBUG**: ะะตัะฐะปะธ ะบะตัะธัะพะฒะฐะฝะธั
- **WARNING**: ะะพะทะฒัะฐั ะบ ัััะฐัะตะฒัะธะผ ะดะฐะฝะฝัะผ
- **ERROR**: ะัะธะฑะบะธ API ะธ ะธัะบะปััะตะฝะธั

## ๐ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะะพะฝัะปะธะบั ะฟะพััะพะฒ
```bash
# ะัะพะฒะตัะธัั ะทะฐะฝัััะต ะฟะพััั
lsof -i :8080  # ะะตะฑ-ัะตัะฒะตั
lsof -i :3306  # MySQL

# ะััะฐะฝะพะฒะธัั ะบะพะฝัะตะนะฝะตัั
make down
```

### ะัะพะฑะปะตะผั ั API ะบะปััะพะผ
1. ะัะพะฒะตัััะต ะบะปัั ะฒ `.env.local`
2. ะัะพะฒะตัััะต ะปะพะณะธ: `make logs`
3. ะัะพัะตััะธััะนัะต API ะฝะฐะฟััะผัั:
   ```bash
   curl "https://api.weatherapi.com/v1/current.json?key=ะะะจ_ะะะฎะง&q=Moscow"
   ```

### ะัะธััะบะฐ ะบะตัะฐ
```bash
# ะัะธััะธัั ะฒะตัั ะบะตั
make cache-clear

# ะัะธััะธัั ะบะตั ะบะพะฝะบัะตัะฝะพะณะพ ะณะพัะพะดะฐ ัะตัะตะท API
curl -X POST http://localhost:8080/api/weather/Moscow/cache/clear
```

## ๐ ะะตะฟะปะพะน ะฒ ะฟัะพะดะฐะบัะฝ

### 1. ะะฐัััะพะนะบะฐ ะพะบััะถะตะฝะธั
```bash
APP_ENV=prod
APP_DEBUG=0
```

### 2. ะะฟัะธะผะธะทะฐัะธั
```bash
composer install --no-dev --optimize-autoloader
php bin/console cache:clear --env=prod
```

### 3. ะะตะทะพะฟะฐัะฝะพััั
- ะัะฟะพะปัะทัะนัะต HTTPS
- ะฃััะฐะฝะพะฒะธัะต ะฝะฐะดะตะถะฝัะต ะฟะฐัะพะปะธ ะะ
- ะะตะณัะปััะฝะพ ะพะฑะฝะพะฒะปัะนัะต API ะบะปััะธ
- ะะพะฝะธัะพัััะต ะปะธะผะธัั API

## ๐ ะะธัะตะฝะทะธั

ะญัะพั ะฟัะพะตะบั ัะพะทะดะฐะฝ ะฒ ััะตะฑะฝัั ัะตะปัั.

## ๐จโ๐ป ะะฒัะพั

ะกะพะทะดะฐะฝะพ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ Symfony ะธ ะปัััะธั ะฟัะฐะบัะธะบ ัะฐะทัะฐะฑะพัะบะธ.

---

๐ก **ะกะพะฒะตั**: ะะปั ัะตะฐะปัะฝัั ะดะฐะฝะฝัั ะพ ะฟะพะณะพะดะต ะพะฑัะทะฐัะตะปัะฝะพ ะทะฐะผะตะฝะธัะต ัะตััะพะฒัะน API ะบะปัั ะฝะฐ ะฝะฐััะพััะธะน!
